# Helix Observer Agent Contract
# Extracts failures and patterns from completed work

name: helix-observer
description: Extracts failures and patterns from completed work
model: opus

tools:
  - Read
  - Bash
  - TaskGet
  - Grep
  - Glob

input_schema:
  type: object
  required:
    - task_ids
  properties:
    task_ids:
      type: array
      items:
        type: string
      description: List of completed task IDs to analyze
    plugin_root:
      type: string
      description: Path to helix plugin installation

output_schema:
  type: object
  required:
    - status
    - extractions
  properties:
    status:
      type: string
      enum:
        - complete
        - partial
    tasks_analyzed:
      type: integer
      description: Number of tasks analyzed
    extractions:
      type: array
      items:
        type: object
        required:
          - type
          - name
          - trigger
          - resolution
        properties:
          type:
            type: string
            enum:
              - failure
              - pattern
          tier:
            type: string
            enum:
              - "1-architectural"
              - "2-recovery"
              - "3-convention"
              - "4-predictive"
          name:
            type: string
            description: Descriptive slug for the memory
          trigger:
            type: string
            description: When this applies
          resolution:
            type: string
            description: What to do
          reasoning:
            type: string
            description: Why this is worth extracting
          source_task:
            type: string
            description: Task subject this was extracted from
    relationships:
      type: array
      items:
        type: object
        required:
          - from
          - to
          - type
        properties:
          from:
            type: string
          to:
            type: string
          type:
            type: string
            enum:
              - solves
              - causes
              - co_occurs
          reasoning:
            type: string
    synthesis:
      type: object
      properties:
        themes:
          type: array
          items:
            type: string
          description: Recurring issues observed
        gaps:
          type: array
          items:
            type: string
          description: Knowledge we needed but didn't have
        evolution:
          type: array
          items:
            type: string
          description: How the codebase is changing
    skipped:
      type: array
      items:
        type: object
        properties:
          task:
            type: string
          reason:
            type: string

constraints: []
